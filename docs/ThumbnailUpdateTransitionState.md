# サムネイル更新処理の遷移状態

## 1. 初期状態（削除前）の機能

1. フォルダ選択時
- 指定されたソート順で一覧表示
- 最後に開いていた画像を選択
- スクロール位置を調整
- 表示範囲のサムネイル生成

2. ソート機能
- 日付順/名前順の切り替え
- 昇順/降順の切り替え
- 選択状態の維持

3. フィルタ機能
- レーティングによるフィルタリング
- タグフィルタ
- プロンプトフィルタ

4. サムネイル生成
- 表示範囲の遅延生成
- スクロールに応じた生成
- ウィンドウサイズ変更時の再生成

## 2. 削除後の機能状態

### 2.1 維持される機能
1. フォルダ選択
- フォルダ内の画像一覧の表示
- 基本的なファイル名順でのソート（ObservableCollection<T>の自然順）
- 先頭アイテムの選択

2. レーティングフィルタ（モック実装）
- UI部分は維持
- シンプルな同期的フィルタリング
- 選択状態の基本的な維持

3. 基本的なサムネイル表示
- 即時生成方式
- 固定サイズでの表示

### 2.2 一時的に無効化される機能
1. ソート機能
- 日付順ソートの無効化
- ソート方向切り替えの無効化
- UIコントロールの非表示

2. 高度なフィルタ機能
- タグフィルタの無効化
- プロンプトフィルタの無効化

3. パフォーマンス最適化
- 遅延サムネイル生成の無効化
- スクロール連動生成の無効化
- サイズ変更時の最適化無効化

## 3. 想定される動作の変化

### 3.1 パフォーマンスへの影響
1. サムネイル生成
- メリット: 実装がシンプルで予測しやすい
- デメリット: 初期ロードが遅くなる可能性

2. メモリ使用
- メリット: キャッシュ関連のメモリリークの可能性が減少
- デメリット: 全サムネイルを保持するためメモリ使用量が増加

3. UI応答性
- メリット: 複雑な非同期処理による競合の可能性が減少
- デメリット: 大量のファイルがある場合にUI がブロックされる可能性

### 3.2 ユーザー体験の変化
1. フォルダ選択時
- 選択→表示までの流れが単純化
- 初期表示に時間がかかる可能性

2. フィルタリング
- レーティングフィルタのみ利用可能
- フィルタ適用がより即時的に

3. 画像の並び順
- ファイル名順のみとなる
- 並び順の変更オプションなし

## 4. 一時的な制限事項

1. ファイル数制限
- 推奨最大ファイル数: 1000件程度
- それ以上の場合はパフォーマンス低下の可能性

2. メモリ使用量
- 大量のファイルがある場合はメモリ使用量が増加
- 1ファイルあたり約2-3MB（サムネイルサイズによる）

3. 応答性
- フォルダ選択時の初期表示に遅延
- フィルタ適用時の一時的なUI停止

## 5. 推奨される運用

1. フォルダ構成
- 1フォルダあたりのファイル数を制限
- 必要に応じてサブフォルダに分割

2. 画像の整理
- ファイル名での管理を推奨
- 重要度の高い画像は先頭に配置

3. パフォーマンス対策
- 大量ファイルの場合は分割して操作
- 必要に応じてキャッシュクリア

## 6. 次フェーズでの改善項目

1. 優先度高
- パフォーマンス改善
- 非同期サムネイル生成
- ソート機能の復活

2. 優先度中
- メモリ使用量の最適化
- UI応答性の改善
- フィルタ機能の拡充

3. 優先度低
- キャッシュ機能の再実装
- 高度なソート機能
- 表示の最適化
