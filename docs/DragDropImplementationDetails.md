# サムネイル一覧からフォルダツリーへのドラッグ＆ドロップ機能

## 実装概要

サムネイル一覧から複数ファイル選択して、ドラッグ＆ドロップでフォルダツリーにドロップしてコピーや移動を可能にする機能を実装しました。

## 実装内容

### 1. ドラッグ元（ThumbnailListControl）

サムネイル一覧からのドラッグ操作は既に実装されており、以下の機能が提供されています：

- 複数選択（Ctrl+クリックやShift+クリックで複数ファイル選択）
- ドラッグ開始の判定
- ドラッグ視覚効果の表示
- ドラッグデータの設定（ファイルパスのリスト）

### 2. ドロップ先（FileSystemTreeView）

フォルダツリーでのドロップ操作を新たに実装し、以下の機能を追加しました：

- ドロップの受け入れ（AllowDrop="True"）
- ドラッグオーバー時の処理（TreeView_DragOver）
  - ドロップ先がフォルダかどうかの判定
  - ドラッグ効果の設定（Ctrlキーでコピー、それ以外で移動）
  - **ドロップ先フォルダのハイライト表示**（視覚的フィードバック）
- ドロップ時の処理（TreeView_Drop）
  - ドロップされたファイルのパスの取得
  - ドロップ先のフォルダパスの取得
  - FileOperationHelperを使用したファイルのコピーまたは移動

### 3. 視覚的フィードバック

- ドラッグ中にドロップ可能なフォルダが薄い緑色でハイライト表示されます
- ドロップ不可能な場所ではカーソルが変わり、ドロップできないことを示します
- ドロップ後またはドラッグキャンセル時にはハイライトが自動的に解除されます

## 使用方法

1. サムネイル一覧で1つまたは複数のファイルを選択
   - 単一選択：ファイルをクリック
   - 複数選択：Ctrlキーを押しながら複数のファイルをクリック、またはShiftキーを押しながら範囲選択

2. 選択したファイルをドラッグ
   - マウスの左ボタンを押したまま、選択したファイルをドラッグ

3. フォルダツリーのフォルダにドロップ
   - ドロップ可能なフォルダは緑色にハイライトされます
   - コピー操作：Ctrlキーを押しながらドロップ
   - 移動操作：そのままドロップ

## 注意事項

- ドロップ先はフォルダである必要があります。ファイルにドロップすることはできません。
- ファイル操作中にエラーが発生した場合は、エラーメッセージが表示されます。
- サムネイル一覧は FileSystemWatcher でフォルダへのファイル追加、削除を監視しているため、ドラッグ＆ドロップ後のアイテムの更新処理は自動的に行われます。
